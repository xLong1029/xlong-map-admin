import{fV as h,fW as p,iP as n,a$ as a,bf as d,j6 as u,aW as t,aX as r,aY as l,bd as c}from"./vendor.70daa49e.js";import{c as o}from"./Graphics3DFrustumVisibility.e75a2fa1.js";import{E as g}from"./Graphics3DGraphicLikeLayerView.bbb082ab.js";import{l as y}from"./projectExtentUtils.14602c98.js";import"./Graphics3DScaleVisibility.0816abff.js";import"./rendererConversion.409e8cbe.js";import"./optimizedFeatureQueryEngineAdapter.a39515e3.js";import"./centroid.76062f7d.js";import"./PooledRBush.644941f3.js";import"./Graphics3DObjectStates.e1548025.js";const m=1.2;let s=class extends h(p){constructor(){super(...arguments),this.type="graphics-3d",this.frustumVisibility=new o,this.slicePlaneEnabled=!1,this.drapeSourceType=1,this.suspendResumeExtent=null,this.fullExtentInLocalViewSpatialReference=null}initialize(){this._set("graphics3d",new g({owner:this,layer:this.layer,scaleVisibilityEnabled:!0})),this.graphics3d.setup(),this.frustumVisibility.setup(this),this.setupSuspendResumeExtent(),this.updatingHandles.add(this,"fullOpacity",()=>this.graphics3d.graphicsCore.opacityChange()),this.handles.add(this.layer.on("graphic-update",i=>this.graphics3d.graphicsCore.graphicUpdateHandler(i))),this.addResolvingPromise(y(this).then(i=>this.fullExtentInLocalViewSpatialReference=i)),this.layer.internal?this.notifyChange("updating"):this.handles.add(n(this.view,"basemapTerrain.ready",()=>this.notifyChange("updating")))}destroy(){this.frustumVisibility&&(this.frustumVisibility.destroy(),this._set("frustumVisibility",null)),this.graphics3d&&(this.graphics3d.destroy(),this._set("graphics3d",null))}get legendEnabled(){return this.canResume()&&!this.frustumVisibility.suspended}get suspendInfo(){var i;const e={};return a(this.graphics3d.scaleVisibility)&&this.graphics3d.scaleVisibility.suspended&&(e.outsideScaleRange=!0),e.outsideOfView=!((i=this.frustumVisibility)==null||!i.suspended),e}async fetchPopupFeatures(i,e){return a(e)?e.clientGraphics:null}notifyGraphicGeometryChanged(i){this.graphics3d.graphicsCore.notifyGraphicGeometryChanged(i)}notifyGraphicVisibilityChanged(i){this.graphics3d.graphicsCore.notifyGraphicVisibilityChanged(i)}get graphics3DGraphics(){return this.graphics3d.graphicsCore.graphics3DGraphics}get graphics3DGraphicsByObjectID(){return this.graphics3d?this.graphics3d.graphicsCore.graphics3DGraphicsByObjectID:null}get symbolUpdateType(){return this.graphics3d.graphicsCore.symbolUpdateType}getGraphicFromGraphicUid(i){return this.graphics3d.getGraphicFromGraphicUid(i)}whenGraphicBounds(i,e){return this.graphics3d.whenGraphicBounds(i,e)}computeAttachmentOrigin(i,e){return this.graphics3d?this.graphics3d.graphicsCore.computeAttachmentOrigin(i,e):null}getSymbolLayerSize(i,e){return this.graphics3d.getSymbolLayerSize(i,e)}queryGraphics(){return Promise.resolve(this.loadedGraphics)}maskOccludee(i){return this.graphics3d.maskOccludee(i)}highlight(i){return this.graphics3d.highlight(i)}get updatePolicy(){var i;return((i=this.graphics3d)==null?void 0:i.graphicsCore.effectiveUpdatePolicy)||1}canResume(){var i;return super.canResume()&&!((i=this.graphics3d)!=null&&i.suspended)}isUpdating(){var i,e;return!(!(this.graphics3d&&this.graphics3d.updating||this.frustumVisibility&&this.frustumVisibility.updating)&&(this.layer.internal||(i=this.view)!=null&&(e=i.basemapTerrain)!=null&&e.ready))}setupSuspendResumeExtent(){const i=()=>{this.suspendResumeExtent=c(this.graphics3d.graphicsCore.computedExtent,this.suspendResumeExtent,m,this.graphics3d.graphicsCore.extentPadding),this.frustumVisibility.setExtent(this.suspendResumeExtent)};d(this.graphics3d.graphicsCore,"computedExtent",()=>i(),!0),u(this.graphics3d.graphicsCore,"extentPadding",()=>i(),!0)}get performanceInfo(){return{displayedNumberOfFeatures:this.loadedGraphics.length,maximumNumberOfFeatures:-1,totalNumberOfFeatures:-1,nodes:0,core:null,updating:this.updating,elevationUpdating:this.graphics3d.elevationAlignment.updating,visibilityFrustum:!this.frustumVisibility.suspended}}};t([r({aliasOf:"layer.graphics"})],s.prototype,"loadedGraphics",void 0),t([r({readOnly:!0})],s.prototype,"suspended",void 0),t([r({readOnly:!0})],s.prototype,"legendEnabled",null),t([r({readOnly:!0})],s.prototype,"updating",void 0),t([r()],s.prototype,"layer",void 0),t([r({readOnly:!0})],s.prototype,"frustumVisibility",void 0),t([r({readOnly:!0})],s.prototype,"graphics3d",void 0),t([r({type:Boolean})],s.prototype,"slicePlaneEnabled",void 0),t([r({readOnly:!0})],s.prototype,"suspendInfo",null),s=t([l("esri.views.3d.layers.GraphicsLayerView3D")],s);const R=s;export{R as default};
