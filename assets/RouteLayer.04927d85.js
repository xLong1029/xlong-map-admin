import{e as t,y as s,lb as F,b as M,g5 as J,gf as X,sV as Te,S as It,hk as D,g7 as A,g8 as z,i as L,ae as ht,aD as x,gd as be,by as ne,tK as $e,qe as At,ga as vt,r as m,fC as wt,aR as gt,g as Y,la as Re,ap as St,i3 as q,dj as K,n as ae,gb as Lt,l9 as je,g3 as jt,fa as Ot,g6 as Dt,F as k,sj as Mt,sk as kt,pU as Ct,pV as Jt,pW as _t,cH as xt,az as Ft,tu as Et,s$ as Ut,qD as it,cA as nt,tg as Gt,eX as Wt,fS as qt,eW as Vt,tL as Zt,u as zt,tM as Kt,tN as Ht,hj as Xt,rV as Qt,h$ as Yt,ms as er,A as tr}from"./index.a33ecea7.js";import{i as rr}from"./originUtils.03ac17cc.js";import{U as ee,y as Oe,s as or,R as sr,r as bt,A as De,c as ir,d as nr,n as ar,w as lr,S as pr,e as at,i as ur,k as cr,j as yr,o as dr,l as mr,b as pe,h as ue,O as re,g as oe,f as se,D as ie,a as me,m as fr}from"./Stop.f34cbdc1.js";let V=class extends J{constructor(e){super(e),this.break=new X({color:[255,255,255],size:12,outline:{color:[0,122,194],width:3}}),this.first=new X({color:[0,255,0],size:20,outline:{color:[255,255,255],width:4}}),this.unlocated=new X({color:[255,0,0],size:12,outline:{color:[255,255,255],width:3}}),this.last=new X({color:[255,0,0],size:20,outline:{color:[255,255,255],width:4}}),this.middle=new X({color:[51,51,51],size:12,outline:{color:[0,122,194],width:3}}),this.waypoint=new X({color:[255,255,255],size:12,outline:{color:[0,122,194],width:3}})}};t([s({types:F})],V.prototype,"break",void 0),t([s({types:F})],V.prototype,"first",void 0),t([s({types:F})],V.prototype,"unlocated",void 0),t([s({types:F})],V.prototype,"last",void 0),t([s({types:F})],V.prototype,"middle",void 0),t([s({types:F})],V.prototype,"waypoint",void 0),V=t([M("esri.layers.support.RouteStopSymbols")],V);const Tt=V;let G=class extends J{constructor(e){super(e),this.directionLines=new Te({color:[0,122,194],width:6}),this.directionPoints=new X({color:[255,255,255],size:6,outline:{color:[0,122,194],width:2}}),this.pointBarriers=new X({style:"x",size:10,outline:{color:[255,0,0],width:3}}),this.polygonBarriers=new It({color:[255,170,0,.6],outline:{width:7.5,color:[255,0,0,.6]}}),this.polylineBarriers=new Te({width:7.5,color:[255,85,0,.7]}),this.routeInfo=new Te({width:8,color:[20,89,127]}),this.stops=new Tt}};t([s({types:F})],G.prototype,"directionLines",void 0),t([s({types:F})],G.prototype,"directionPoints",void 0),t([s({types:F})],G.prototype,"pointBarriers",void 0),t([s({types:F})],G.prototype,"polygonBarriers",void 0),t([s({types:F})],G.prototype,"polylineBarriers",void 0),t([s({types:F})],G.prototype,"routeInfo",void 0),t([s({type:Tt})],G.prototype,"stops",void 0),G=t([M("esri.layers.support.RouteSymbols")],G);const Bt=G;let E=class extends J{constructor(e){super(e),this.dataType=null,this.name=null,this.parameterNames=null,this.restrictionUsageParameterName=null,this.timeNeutralAttributeName=null,this.trafficSupport=null,this.units=null,this.usageType=null}};t([s({type:String})],E.prototype,"dataType",void 0),t([D(ee,{ignoreUnknown:!1})],E.prototype,"name",void 0),t([s({type:[String]})],E.prototype,"parameterNames",void 0),t([s({type:String})],E.prototype,"restrictionUsageParameterName",void 0),t([D(Oe,{ignoreUnknown:!1})],E.prototype,"timeNeutralAttributeName",void 0),t([s({type:String})],E.prototype,"trafficSupport",void 0),t([D(or)],E.prototype,"units",void 0),t([D(sr)],E.prototype,"usageType",void 0),E=t([M("esri.rest.support.NetworkAttribute")],E);const hr=E;let H=class extends J{constructor(e){super(e),this.buildTime=null,this.name=null,this.networkAttributes=null,this.networkSources=null,this.state=null}};t([s({type:Number})],H.prototype,"buildTime",void 0),t([s({type:String})],H.prototype,"name",void 0),t([s({type:[hr]})],H.prototype,"networkAttributes",void 0),t([s()],H.prototype,"networkSources",void 0),t([s({type:String})],H.prototype,"state",void 0),H=t([M("esri.rest.support.NetworkDataset")],H);const vr=H;let O=class extends J{constructor(e){super(e),this.accumulateAttributeNames=null,this.attributeParameterValues=null,this.currentVersion=null,this.defaultTravelMode=null,this.directionsLanguage=null,this.directionsLengthUnits=null,this.directionsSupportedLanguages=null,this.directionsTimeAttribute=null,this.hasZ=null,this.impedance=null,this.networkDataset=null,this.supportedTravelModes=null}readAccumulateAttributes(e){return L(e)?null:e.map(r=>ee.fromJSON(r))}writeAccumulateAttributes(e,r,o){!L(e)&&e.length&&(r[o]=e.map(i=>ee.toJSON(i)))}readDefaultTravelMode(e,r){var i,n,p;const o=(p=(i=r.supportedTravelModes)==null?void 0:i.find(({id:a})=>a===r.defaultTravelMode))!=null?p:(n=r.supportedTravelModes)==null?void 0:n.find(({itemId:a})=>a===r.defaultTravelMode);return o?De.fromJSON(o):null}};t([s()],O.prototype,"accumulateAttributeNames",void 0),t([A("accumulateAttributeNames")],O.prototype,"readAccumulateAttributes",null),t([z("accumulateAttributeNames")],O.prototype,"writeAccumulateAttributes",null),t([s()],O.prototype,"attributeParameterValues",void 0),t([s()],O.prototype,"currentVersion",void 0),t([s()],O.prototype,"defaultTravelMode",void 0),t([A("defaultTravelMode",["defaultTravelMode","supportedTravelModes"])],O.prototype,"readDefaultTravelMode",null),t([s()],O.prototype,"directionsLanguage",void 0),t([D(bt)],O.prototype,"directionsLengthUnits",void 0),t([s()],O.prototype,"directionsSupportedLanguages",void 0),t([D(Oe,{ignoreUnknown:!1})],O.prototype,"directionsTimeAttribute",void 0),t([s()],O.prototype,"hasZ",void 0),t([D(ee,{ignoreUnknown:!1})],O.prototype,"impedance",void 0),t([s({type:vr})],O.prototype,"networkDataset",void 0),t([s({type:[De]})],O.prototype,"supportedTravelModes",void 0),O=t([M("esri.rest.support.NetworkServiceDescription")],O);const wr=O,gr=ht.getLogger("esri.rest.networkService");function fe(e,r,o,i){i[o]=[r.length,r.length+e.length],e.forEach(n=>{r.push(n.geometry)})}function Sr(e,r){for(let o=0;o<r.length;o++){const i=e[r[o]];if(i&&i.length)for(const n of i)n.z=void 0}gr.warnOnce(`The remote Network Analysis service is powered by a network dataset which is not Z-aware.
Z-coordinates of the input geometry are ignored.`)}function br(e,r){for(let o=0;o<r.length;o++){const i=e[r[o]];if(i&&i.length){for(const n of i)if(m(n)&&n.hasZ)return!0}}return!1}async function Nt(e,r,o){if(!e)throw new x("network-service:missing-url","Url to Network service is missing");const i=be({f:"json",token:r},o),{data:n}=await ne(e,i),p=n.currentVersion>=10.4?Br(e,r,o):Tr(e,o),{defaultTravelMode:a,supportedTravelModes:c}=await p;return n.defaultTravelMode=a,n.supportedTravelModes=c,wr.fromJSON(n)}async function Tr(e,r){var B,h,d;const o=be({f:"json"},r),{data:i}=await ne(e.replace(/\/rest\/.*$/i,"/info"),o);if(!i||!i.owningSystemUrl)return{supportedTravelModes:[],defaultTravelMode:null};const{owningSystemUrl:n}=i,p=$e(n)+"/sharing/rest/portals/self",{data:a}=await ne(p,o),c=At("helperServices.routingUtilities.url",a);if(!c)return{supportedTravelModes:[],defaultTravelMode:null};const g=vt(n),b=/\/solve$/i.test(g.path)?"Route":/\/solveclosestfacility$/i.test(g.path)?"ClosestFacility":"ServiceAreas",l=be({f:"json",serviceName:b},r),T=$e(c)+"/GetTravelModes/execute",R=await ne(T,l),P=[];let S=null;if((h=(B=R==null?void 0:R.data)==null?void 0:B.results)!=null&&h.length){const f=R.data.results;for(const w of f)if(w.paramName==="supportedTravelModes"){if((d=w.value)!=null&&d.features){for(const{attributes:v}of w.value.features)if(v){const $=JSON.parse(v.TravelMode);P.push($)}}}else w.paramName==="defaultTravelMode"&&(S=w.value)}return{supportedTravelModes:P,defaultTravelMode:S}}async function Br(e,r,o){try{const i=be({f:"json",token:r},o),n=$e(e)+"/retrieveTravelModes",{data:{supportedTravelModes:p,defaultTravelMode:a}}=await ne(n,i);return{supportedTravelModes:p,defaultTravelMode:a}}catch(i){throw new x("network-service:retrieveTravelModes","Could not get to the NAServer's retrieveTravelModes.",{error:i})}}const lt=new wt({esriJobMessageTypeInformative:"informative",esriJobMessageTypeProcessDefinition:"process-definition",esriJobMessageTypeProcessStart:"process-start",esriJobMessageTypeProcessStop:"process-stop",esriJobMessageTypeWarning:"warning",esriJobMessageTypeError:"error",esriJobMessageTypeEmpty:"empty",esriJobMessageTypeAbort:"abort"});let ce=class extends J{constructor(e){super(e),this.description=null,this.type=null}};t([s({type:String,json:{write:!0}})],ce.prototype,"description",void 0),t([s({type:String,json:{read:lt.read,write:lt.write}})],ce.prototype,"type",void 0),ce=t([M("esri.rest.support.GPMessage")],ce);const Nr=ce,pt=new wt({0:"informative",1:"process-definition",2:"process-start",3:"process-stop",50:"warning",100:"error",101:"empty",200:"abort"});let ge=class extends Nr{constructor(e){super(e),this.type=null}};t([s({type:String,json:{read:pt.read,write:pt.write}})],ge.prototype,"type",void 0),ge=t([M("esri.rest.support.NAMessage")],ge);const Pr=ge;let ye=class extends J{constructor(e){super(e)}};t([s({json:{read:{source:"string"}}})],ye.prototype,"text",void 0),t([D(ir,{name:"stringType"})],ye.prototype,"type",void 0),ye=t([M("esri.rest.support.DirectionsString")],ye);const Pt=ye;let Z=class extends J{constructor(e){super(e),this.arriveTime=null,this.arriveTimeOffset=null,this.geometry=null,this.strings=null}readArriveTimeOffset(e,r){return nr(r.ETA,r.arriveTimeUTC)}readGeometry(e,r){return gt.fromJSON(r.point)}};t([s({type:Date,json:{read:{source:"arriveTimeUTC"}}})],Z.prototype,"arriveTime",void 0),t([s()],Z.prototype,"arriveTimeOffset",void 0),t([A("arriveTimeOffset",["arriveTimeUTC","ETA"])],Z.prototype,"readArriveTimeOffset",null),t([s({type:gt})],Z.prototype,"geometry",void 0),t([A("geometry",["point"])],Z.prototype,"readGeometry",null),t([s({type:[Pt]})],Z.prototype,"strings",void 0),Z=t([M("esri.rest.support.DirectionsEvent")],Z);const $r=Z;function Rr(e){if(L(e)||e==="")return null;let r=0,o=0,i=0,n=0;const p=[];let a,c,g,b,l,T,R,P,S=0,B=0,h=0;if(l=e.match(/((\+|\-)[^\+\-\|]+|\|)/g),l||(l=[]),parseInt(l[S],32)===0){S=2;const d=parseInt(l[S],32);S++,T=parseInt(l[S],32),S++,1&d&&(B=l.indexOf("|")+1,R=parseInt(l[B],32),B++),2&d&&(h=l.indexOf("|",B)+1,P=parseInt(l[h],32),h++)}else T=parseInt(l[S],32),S++;for(;S<l.length&&l[S]!=="|";){a=parseInt(l[S],32)+r,S++,r=a,c=parseInt(l[S],32)+o,S++,o=c;const d=[a/T,c/T];B&&(b=parseInt(l[B],32)+i,B++,i=b,d.push(b/R)),h&&(g=parseInt(l[h],32)+n,h++,n=g,d.push(g/P)),p.push(d)}return{paths:[p],hasZ:B>0,hasM:h>0}}let te=class extends Y{constructor(e){super(e),this.events=null,this.strings=null}readGeometry(e,r){const o=Rr(r.compressedGeometry);return m(o)?Re.fromJSON(o):null}};t([s({type:[$r]})],te.prototype,"events",void 0),t([A("geometry",["compressedGeometry"])],te.prototype,"readGeometry",null),t([s({type:[Pt]})],te.prototype,"strings",void 0),te=t([M("esri.rest.support.DirectionsFeature")],te);const Ir=te;function Ar(e,r){if(e.length===0)return new Re({spatialReference:r});const o=[];for(const a of e)for(const c of a.paths)o.push(...c);const i=[];o.forEach((a,c)=>{c!==0&&a[0]===o[c-1][0]&&a[1]===o[c-1][1]||i.push(a)});const{hasM:n,hasZ:p}=e[0];return new Re({hasM:n,hasZ:p,paths:[i],spatialReference:r})}let C=class extends q{constructor(e){super(e),this.extent=null,this.features=[],this.geometryType="polyline",this.routeId=null,this.routeName=null,this.totalDriveTime=null,this.totalLength=null,this.totalTime=null}readFeatures(e,r){var n;if(!e)return[];const o=(n=r.summary.envelope.spatialReference)!=null?n:r.spatialReference,i=o&&K.fromJSON(o);return e.map(p=>{const a=Ir.fromJSON(p);if(m(a.geometry)&&(a.geometry.spatialReference=i),m(a.events))for(const c of a.events)m(c.geometry)&&(c.geometry.spatialReference=i);return a})}get mergedGeometry(){return this.features?Ar(this.features.map(({geometry:e})=>ae(e)),this.extent.spatialReference):null}get strings(){return this.features.map(({strings:e})=>e).flat().filter(m)}};t([s({type:St,json:{read:{source:"summary.envelope"}}})],C.prototype,"extent",void 0),t([s({nonNullable:!0})],C.prototype,"features",void 0),t([A("features")],C.prototype,"readFeatures",null),t([s()],C.prototype,"geometryType",void 0),t([s({readOnly:!0})],C.prototype,"mergedGeometry",null),t([s()],C.prototype,"routeId",void 0),t([s()],C.prototype,"routeName",void 0),t([s({value:null,readOnly:!0})],C.prototype,"strings",null),t([s({json:{read:{source:"summary.totalDriveTime"}}})],C.prototype,"totalDriveTime",void 0),t([s({json:{read:{source:"summary.totalLength"}}})],C.prototype,"totalLength",void 0),t([s({json:{read:{source:"summary.totalTime"}}})],C.prototype,"totalTime",void 0),C=t([M("esri.rest.support.DirectionsFeatureSet")],C);const Lr=C;let _=class extends J{constructor(e){super(e),this.directionLines=null,this.directionPoints=null,this.directions=null,this.route=null,this.routeName=null,this.stops=null,this.traversedEdges=null,this.traversedJunctions=null,this.traversedTurns=null}};t([s({type:q,json:{write:!0}})],_.prototype,"directionLines",void 0),t([s({type:q,json:{write:!0}})],_.prototype,"directionPoints",void 0),t([s({type:Lr,json:{write:!0}})],_.prototype,"directions",void 0),t([s({type:Y,json:{write:!0}})],_.prototype,"route",void 0),t([s({type:String,json:{write:!0}})],_.prototype,"routeName",void 0),t([s({type:[Y],json:{write:!0}})],_.prototype,"stops",void 0),t([s({type:q,json:{write:!0}})],_.prototype,"traversedEdges",void 0),t([s({type:q,json:{write:!0}})],_.prototype,"traversedJunctions",void 0),t([s({type:q,json:{write:!0}})],_.prototype,"traversedTurns",void 0),_=t([M("esri.rest.support.RouteResult")],_);const jr=_;function Be(e){return e?q.fromJSON(e).features.filter(m):[]}let U=class extends J{constructor(e){super(e),this.messages=null,this.pointBarriers=null,this.polylineBarriers=null,this.polygonBarriers=null,this.routeResults=null}readPointBarriers(e,r){return Be(r.barriers)}readPolylineBarriers(e){return Be(e)}readPolygonBarriers(e){return Be(e)}};t([s({type:[Pr]})],U.prototype,"messages",void 0),t([s({type:[Y]})],U.prototype,"pointBarriers",void 0),t([A("pointBarriers",["barriers"])],U.prototype,"readPointBarriers",null),t([s({type:[Y]})],U.prototype,"polylineBarriers",void 0),t([A("polylineBarriers")],U.prototype,"readPolylineBarriers",null),t([s({type:[Y]})],U.prototype,"polygonBarriers",void 0),t([A("polygonBarriers")],U.prototype,"readPolygonBarriers",null),t([s({type:[jr]})],U.prototype,"routeResults",void 0),U=t([M("esri.rest.support.RouteSolveResult")],U);const Or=U;function he(e){return e instanceof q}async function Dr(e,r,o){const i=[],n=[],p={},a={},c=vt(e),{path:g}=c;he(r.stops)&&fe(r.stops.features,n,"stops.features",p),he(r.pointBarriers)&&fe(r.pointBarriers.features,n,"pointBarriers.features",p),he(r.polylineBarriers)&&fe(r.polylineBarriers.features,n,"polylineBarriers.features",p),he(r.polygonBarriers)&&fe(r.polygonBarriers.features,n,"polygonBarriers.features",p);const b=await Lt(n);for(const P in p){const S=p[P];i.push(P),a[P]=b.slice(S[0],S[1])}if(br(a,i)){let P=null;try{P=await Nt(g,r.apiKey,o)}catch{}P&&!P.hasZ&&Sr(a,i)}for(const P in a)a[P].forEach((S,B)=>{r.get(P)[B].geometry=S});const l={...o,query:{...c.query,...ar(r),f:"json"}},T=g.endsWith("/solve")?g:`${g}/solve`,{data:R}=await ne(T,l);return Mr(R)}function Mr(e){var d;const{barriers:r,directionLines:o,directionPoints:i,directions:n,messages:p,polygonBarriers:a,polylineBarriers:c,routes:g,stops:b,traversedEdges:l,traversedJunctions:T,traversedTurns:R}=e,P=f=>{const w=B.find($=>$.routeName===f);if(m(w))return w;const v={routeId:B.length+1,routeName:f};return B.push(v),v},S=f=>{const w=B.find($=>$.routeId===f);if(m(w))return w;const v={routeId:f,routeName:null};return B.push(v),v},B=[];g==null||g.features.forEach((f,w)=>{f.geometry.spatialReference=g.spatialReference;const v=f.attributes.Name,$=w+1;B.push({routeId:$,routeName:v,route:f})}),n==null||n.forEach(f=>{const{routeName:w}=f;P(w).directions=f});const h=((d=b==null?void 0:b.features.every(f=>L(f.attributes.RouteName)))!=null?d:!1)&&B.length>0?B[0].routeName:null;return b==null||b.features.forEach(f=>{var I,j;var w;f.geometry&&((I=(w=f.geometry).spatialReference)!=null||(w.spatialReference=b.spatialReference));const v=h!=null?h:f.attributes.RouteName,$=P(v);(j=$.stops)!=null||($.stops=[]),$.stops.push(f)}),o==null||o.features.forEach(f=>{var j;const w=f.attributes.RouteID,v=S(w),{geometryType:$,spatialReference:I}=o;(j=v.directionLines)!=null||(v.directionLines={features:[],geometryType:$,spatialReference:I}),v.directionLines.features.push(f)}),i==null||i.features.forEach(f=>{var j;const w=f.attributes.RouteID,v=S(w),{geometryType:$,spatialReference:I}=i;(j=v.directionPoints)!=null||(v.directionPoints={features:[],geometryType:$,spatialReference:I}),v.directionPoints.features.push(f)}),l==null||l.features.forEach(f=>{var j;const w=f.attributes.RouteID,v=S(w),{geometryType:$,spatialReference:I}=l;(j=v.traversedEdges)!=null||(v.traversedEdges={features:[],geometryType:$,spatialReference:I}),v.traversedEdges.features.push(f)}),T==null||T.features.forEach(f=>{var j;const w=f.attributes.RouteID,v=S(w),{geometryType:$,spatialReference:I}=T;(j=v.traversedJunctions)!=null||(v.traversedJunctions={features:[],geometryType:$,spatialReference:I}),v.traversedJunctions.features.push(f)}),R==null||R.features.forEach(f=>{var $;const w=f.attributes.RouteID,v=S(w);($=v.traversedTurns)!=null||(v.traversedTurns={features:[]}),v.traversedTurns.features.push(f)}),Or.fromJSON({routeResults:B,barriers:r,polygonBarriers:a,polylineBarriers:c,messages:p})}const kr={type:String,json:{read:{source:"token"},write:{target:"token"}}};let W=class extends je(J){constructor(e){super(e),this.doNotLocateOnRestrictedElements=null,this.geometry=null,this.geometryType=null,this.name=null,this.spatialRelationship=null,this.type="layer",this.where=null}};t([s({type:Boolean,json:{write:!0}})],W.prototype,"doNotLocateOnRestrictedElements",void 0),t([s({types:jt,json:{read:Ot,write:!0}})],W.prototype,"geometry",void 0),t([D(lr)],W.prototype,"geometryType",void 0),t([s({type:String,json:{name:"layerName",write:!0}})],W.prototype,"name",void 0),t([D(pr,{name:"spatialRel"})],W.prototype,"spatialRelationship",void 0),t([s({type:String,json:{write:!0}})],W.prototype,"type",void 0),t([s({type:String,json:{write:!0}})],W.prototype,"where",void 0),W=t([M("esri.rest.support.DataLayer")],W);const Cr=W;var Ie;let Se=Ie=class extends q{constructor(e){super(e),this.doNotLocateOnRestrictedElements=null}clone(){return new Ie({doNotLocateOnRestrictedElements:this.doNotLocateOnRestrictedElements,...this.cloneProperties()})}};t([s({type:Boolean,json:{write:!0}})],Se.prototype,"doNotLocateOnRestrictedElements",void 0),Se=Ie=t([M("esri.rest.support.NetworkFeatureSet")],Se);const Jr=Se;let de=class extends je(J){constructor(e){super(e),this.doNotLocateOnRestrictedElements=null,this.url=null}};t([s({type:Boolean,json:{write:!0}})],de.prototype,"doNotLocateOnRestrictedElements",void 0),t([s({type:String,json:{write:!0}})],de.prototype,"url",void 0),de=t([M("esri.rest.support.NetworkUrl")],de);const _r=de;var Ae;function xr(e){return e&&"type"in e}function Fr(e){return e&&"features"in e&&"doNotLocateOnRestrictedElements"in e}function Er(e){return e&&"url"in e}function Ur(e){return e&&"features"in e}function Gr(e){return xr(e)?Cr.fromJSON(e):Er(e)?_r.fromJSON(e):Fr(e)?Jr.fromJSON(e):Ur(e)?q.fromJSON(e):null}function ve(e,r,o){m(e)&&(r[o]=k.isCollection(e)?{features:e.toArray().map(i=>i.toJSON())}:e.toJSON())}let u=Ae=class extends je(J){constructor(e){super(e),this.accumulateAttributes=null,this.apiKey=null,this.attributeParameterValues=null,this.directionsLanguage=null,this.directionsLengthUnits=null,this.directionsOutputType=null,this.directionsStyleName=null,this.directionsTimeAttribute=null,this.findBestSequence=null,this.geometryPrecision=null,this.geometryPrecisionM=null,this.geometryPrecisionZ=null,this.ignoreInvalidLocations=null,this.impedanceAttribute=null,this.outputGeometryPrecision=null,this.outputGeometryPrecisionUnits=null,this.outputLines="true-shape",this.outSpatialReference=null,this.overrides=null,this.pointBarriers=null,this.polygonBarriers=null,this.polylineBarriers=null,this.preserveFirstStop=null,this.preserveLastStop=null,this.preserveObjectID=null,this.restrictionAttributes=null,this.restrictUTurns=null,this.returnBarriers=!1,this.returnDirections=!1,this.returnPolygonBarriers=!1,this.returnPolylineBarriers=!1,this.returnRoutes=!0,this.returnStops=!1,this.returnTraversedEdges=null,this.returnTraversedJunctions=null,this.returnTraversedTurns=null,this.returnZ=!0,this.startTime=null,this.startTimeIsUTC=!0,this.stops=null,this.timeWindowsAreUTC=null,this.travelMode=null,this.useHierarchy=null,this.useTimeWindows=null}static from(e){return Dt(Ae,e)}readAccumulateAttributes(e){return L(e)?null:e.map(r=>ee.fromJSON(r))}writeAccumulateAttributes(e,r,o){!L(e)&&e.length&&(r[o]=e.map(i=>ee.toJSON(i)))}writePointBarriers(e,r,o){ve(e,r,o)}writePolygonBarrier(e,r,o){ve(e,r,o)}writePolylineBarrier(e,r,o){ve(e,r,o)}readRestrictionAttributes(e){return L(e)?null:e.map(r=>at.fromJSON(r))}writeRestrictionAttributes(e,r,o){!L(e)&&e.length&&(r[o]=e.map(i=>at.toJSON(i)))}readStartTime(e,r){const{startTime:o}=r;return L(o)?null:o==="now"?"now":new Date(o)}writeStartTime(e,r){L(e)||(r.startTime=e==="now"?"now":e.getTime())}readStops(e,r){return Gr(r.stops)}writeStops(e,r,o){ve(e,r,o)}};t([s({type:[String],json:{name:"accumulateAttributeNames",write:!0}})],u.prototype,"accumulateAttributes",void 0),t([A("accumulateAttributes")],u.prototype,"readAccumulateAttributes",null),t([z("accumulateAttributes")],u.prototype,"writeAccumulateAttributes",null),t([s(kr)],u.prototype,"apiKey",void 0),t([s({json:{write:!0}})],u.prototype,"attributeParameterValues",void 0),t([s({type:String,json:{write:!0}})],u.prototype,"directionsLanguage",void 0),t([D(bt)],u.prototype,"directionsLengthUnits",void 0),t([D(ur)],u.prototype,"directionsOutputType",void 0),t([D(cr)],u.prototype,"directionsStyleName",void 0),t([D(Oe,{name:"directionsTimeAttributeName",ignoreUnknown:!1})],u.prototype,"directionsTimeAttribute",void 0),t([s({type:Boolean,json:{write:!0}})],u.prototype,"findBestSequence",void 0),t([s({type:Number,json:{write:!0}})],u.prototype,"geometryPrecision",void 0),t([s({type:Number,json:{write:!0}})],u.prototype,"geometryPrecisionM",void 0),t([s({type:Number,json:{write:!0}})],u.prototype,"geometryPrecisionZ",void 0),t([s({type:Boolean,json:{write:!0}})],u.prototype,"ignoreInvalidLocations",void 0),t([D(ee,{name:"impedanceAttributeName",ignoreUnknown:!1})],u.prototype,"impedanceAttribute",void 0),t([s({type:Number,json:{write:!0}})],u.prototype,"outputGeometryPrecision",void 0),t([D(yr)],u.prototype,"outputGeometryPrecisionUnits",void 0),t([D(dr)],u.prototype,"outputLines",void 0),t([s({type:K,json:{name:"outSR",write:!0}})],u.prototype,"outSpatialReference",void 0),t([s({json:{write:!0}})],u.prototype,"overrides",void 0),t([s({json:{name:"barriers",write:!0}})],u.prototype,"pointBarriers",void 0),t([z("pointBarriers")],u.prototype,"writePointBarriers",null),t([s({json:{write:!0}})],u.prototype,"polygonBarriers",void 0),t([z("polygonBarriers")],u.prototype,"writePolygonBarrier",null),t([s({json:{write:!0}})],u.prototype,"polylineBarriers",void 0),t([z("polylineBarriers")],u.prototype,"writePolylineBarrier",null),t([s({type:Boolean,json:{write:!0}})],u.prototype,"preserveFirstStop",void 0),t([s({type:Boolean,json:{write:!0}})],u.prototype,"preserveLastStop",void 0),t([s({type:Boolean,json:{write:!0}})],u.prototype,"preserveObjectID",void 0),t([s({type:[String],json:{name:"restrictionAttributeNames",write:!0}})],u.prototype,"restrictionAttributes",void 0),t([A("restrictionAttributes")],u.prototype,"readRestrictionAttributes",null),t([z("restrictionAttributes")],u.prototype,"writeRestrictionAttributes",null),t([D(mr)],u.prototype,"restrictUTurns",void 0),t([s({type:Boolean,json:{write:!0}})],u.prototype,"returnBarriers",void 0),t([s({type:Boolean,json:{write:!0}})],u.prototype,"returnDirections",void 0),t([s({type:Boolean,json:{write:!0}})],u.prototype,"returnPolygonBarriers",void 0),t([s({type:Boolean,json:{write:!0}})],u.prototype,"returnPolylineBarriers",void 0),t([s({type:Boolean,json:{write:!0}})],u.prototype,"returnRoutes",void 0),t([s({type:Boolean,json:{write:!0}})],u.prototype,"returnStops",void 0),t([s({type:Boolean,json:{write:!0}})],u.prototype,"returnTraversedEdges",void 0),t([s({type:Boolean,json:{write:!0}})],u.prototype,"returnTraversedJunctions",void 0),t([s({type:Boolean,json:{write:!0}})],u.prototype,"returnTraversedTurns",void 0),t([s({type:Boolean,json:{write:!0}})],u.prototype,"returnZ",void 0),t([s({type:Date,json:{type:Number,write:!0}})],u.prototype,"startTime",void 0),t([A("startTime")],u.prototype,"readStartTime",null),t([z("startTime")],u.prototype,"writeStartTime",null),t([s({type:Boolean,json:{write:!0}})],u.prototype,"startTimeIsUTC",void 0),t([s({json:{write:!0}})],u.prototype,"stops",void 0),t([A("stops")],u.prototype,"readStops",null),t([z("stops")],u.prototype,"writeStops",null),t([s({type:Boolean,json:{write:!0}})],u.prototype,"timeWindowsAreUTC",void 0),t([s({type:De,json:{write:!0}})],u.prototype,"travelMode",void 0),t([s({type:Boolean,json:{write:!0}})],u.prototype,"useHierarchy",void 0),t([s({type:Boolean,json:{write:!0}})],u.prototype,"useTimeWindows",void 0),u=Ae=t([M("esri.rest.support.RouteParameters")],u);const ut=u;function Ne(e){return e.length?e:null}function Le(e){switch(e){case"esriGeometryPoint":return{type:"esriSMS",style:"esriSMSCircle",size:12,color:[0,0,0,0],outline:Le("esriGeometryPolyline")};case"esriGeometryPolyline":return{type:"esriSLS",style:"esriSLSSolid",width:1,color:[0,0,0,0]};case"esriGeometryPolygon":return{type:"esriSFS",style:"esriSFSNull",outline:Le("esriGeometryPolyline")}}}function we(e){return"layers"in e}function Wr(e){return e.declaredClass==="esri.rest.support.FeatureSet"}function qr(e){return e.declaredClass==="esri.rest.support.NetworkFeatureSet"}function Vr(e,r,o){var j,le,Me,ke,Ce,Je,_e,xe,Fe,Ee,Ue,Ge,We,qe,Ve,Ze,ze,Ke,He,Xe,Qe,Ye,et,tt,rt,ot;const i=(j=r.networkDataset)==null?void 0:j.networkAttributes,n=(le=i==null?void 0:i.filter(({usageType:y})=>y==="cost"))!=null?le:[],p=(Me=o.travelMode)!=null?Me:r.defaultTravelMode;if(L(p))return void Rt.warn("route-layer:missing-travel-mode","The routing service must have a default travel mode or one must be specified in the route parameter.");const{timeAttributeName:a,distanceAttributeName:c}=p,g=n.find(({name:y})=>y===a),b=n.find(({name:y})=>y===c),l=(Je=(Ce=(ke=ae(o.travelMode))==null?void 0:ke.impedanceAttributeName)!=null?Ce:ae(o.impedanceAttribute))!=null?Je:r.impedance,T=g==null?void 0:g.units,R=b==null?void 0:b.units;if(!T||!R)throw new x("routelayer:unknown-impedance-units","the units of either the distance or time impedance are unknown");const P=(_e=o.directionsLanguage)!=null?_e:r.directionsLanguage,S=(Fe=(xe=ae(o.accumulateAttributes))!=null?xe:r.accumulateAttributeNames)!=null?Fe:[],B=new Set(n.filter(({name:y})=>y===a||y===c||y===l||y!=null&&S.includes(y)).map(({name:y})=>y)),h=y=>{for(const st in y)B.has(st)||delete y[st]};for(const y of e.pointBarriers)m(y.costs)&&(y.addedCost=(Ee=y.costs[l])!=null?Ee:0,h(y.costs));for(const y of e.polygonBarriers)m(y.costs)&&(y.scaleFactor=(Ue=y.costs[l])!=null?Ue:1,h(y.costs));for(const y of e.polylineBarriers)m(y.costs)&&(y.scaleFactor=(Ge=y.costs[l])!=null?Ge:1,h(y.costs));const{routeInfo:d}=e,{findBestSequence:f,preserveFirstStop:w,preserveLastStop:v,startTimeIsUTC:$,timeWindowsAreUTC:I}=o;d.analysisSettings=new fr({accumulateAttributes:S,directionsLanguage:P,findBestSequence:f,preserveFirstStop:w,preserveLastStop:v,startTimeIsUTC:$,timeWindowsAreUTC:I,travelMode:p}),d.totalDuration=Q((qe=(We=d.totalCosts)==null?void 0:We[a])!=null?qe:0,T),d.totalDistance=Pe((Ze=(Ve=d.totalCosts)==null?void 0:Ve[c])!=null?Ze:0,R),d.totalLateDuration=Q((Ke=(ze=d.totalViolations)==null?void 0:ze[a])!=null?Ke:0,T),d.totalWaitDuration=Q((Xe=(He=d.totalWait)==null?void 0:He[a])!=null?Xe:0,T),m(d.totalCosts)&&h(d.totalCosts),m(d.totalViolations)&&h(d.totalViolations),m(d.totalWait)&&h(d.totalWait);for(const y of e.stops)m(y.serviceCosts)&&(y.serviceDuration=Q((Qe=y.serviceCosts[a])!=null?Qe:0,T),y.serviceDistance=Pe((Ye=y.serviceCosts[c])!=null?Ye:0,R),h(y.serviceCosts)),m(y.cumulativeCosts)&&(y.cumulativeDuration=Q((et=y.cumulativeCosts[a])!=null?et:0,T),y.cumulativeDistance=Pe((tt=y.cumulativeCosts[c])!=null?tt:0,R),h(y.cumulativeCosts)),m(y.violations)&&(y.lateDuration=Q((rt=y.violations[a])!=null?rt:0,T),h(y.violations)),m(y.wait)&&(y.waitDuration=Q((ot=y.wait[a])!=null?ot:0,T),h(y.wait))}async function ct(e){const r=K.WGS84;return await Qt(e.spatialReference,r),Yt(e,r)}function Q(e,r){switch(r){case"seconds":return e/60;case"hours":return 60*e;case"days":return 60*e*24;default:return e}}function Pe(e,r){return r==="decimal-degrees"||r==="points"||r==="unknown"?e:er(e,r,"meters")}function Zr(e){const{attributes:r,geometry:o,popupTemplate:i,symbol:n}=e.toGraphic().toJSON();return{attributes:r,geometry:o,popupInfo:i,symbol:n}}const zr=k.ofType(pe),Kr=k.ofType(ue),yt=k.ofType(re),dt=k.ofType(oe),mt=k.ofType(se),ft=k.ofType(ie),$t="esri.layers.RouteLayer",Rt=ht.getLogger($t);let N=class extends Mt(kt(Ct(Jt(_t(xt(tr)))))){constructor(e){super(e),this._cachedServiceDescription=null,this._featureCollection=null,this._type="Feature Collection",this.defaultSymbols=new Bt,this.directionLines=null,this.directionPoints=null,this.featureCollectionType="route",this.legendEnabled=!1,this.maxScale=0,this.minScale=0,this.pointBarriers=new yt,this.polygonBarriers=new dt,this.polylineBarriers=new mt,this.routeInfo=null,this.spatialReference=K.WGS84,this.stops=new ft,this.type="route";const r=()=>{this._setStopSymbol(this.stops)};this.addHandles(Ft(()=>this.stops,"change",r,{sync:!0,onListenerAdd:r}))}writeFeatureCollectionWebmap(e,r,o,i){const n=[this._writePolygonBarriers(),this._writePolylineBarriers(),this._writePointBarriers(),this._writeRouteInfo(),this._writeDirectionLines(),this._writeDirectionPoints(),this._writeStops()].filter(c=>!!c),p=n.map((c,g)=>g),a=i.origin==="web-map"?"featureCollection.layers":"layers";Et(a,n,r),r.opacity=this.opacity,r.visibility=this.visible,r.visibleLayers=p}readDirectionLines(e,r){return this._getNetworkFeatures(r,"DirectionLines",o=>pe.fromGraphic(o))}readDirectionPoints(e,r){return this._getNetworkFeatures(r,"DirectionPoints",o=>ue.fromGraphic(o))}get fullExtent(){var n;const e=new St({xmin:-180,ymin:-90,xmax:180,ymax:90,spatialReference:K.WGS84});if(m(this.routeInfo)&&m(this.routeInfo.geometry))return(n=this.routeInfo.geometry.extent)!=null?n:e;if(L(this.stops))return e;const r=this.stops.filter(p=>m(p.geometry));if(r.length<2)return e;const{spatialReference:o}=r.getItemAt(0).geometry;if(L(o))return e;const i=r.toArray().map(p=>{const a=p.geometry;return[a.x,a.y]});return new Ut({points:i,spatialReference:o}).extent}readMaxScale(e,r){var i,n,p;const o=(n=we(r)?r.layers:(i=r.featureCollection)==null?void 0:i.layers)==null?void 0:n.find(a=>m(a.layerDefinition.maxScale));return(p=o==null?void 0:o.layerDefinition.maxScale)!=null?p:0}readMinScale(e,r){var i,n,p;const o=(n=we(r)?r.layers:(i=r.featureCollection)==null?void 0:i.layers)==null?void 0:n.find(a=>m(a.layerDefinition.minScale));return(p=o==null?void 0:o.layerDefinition.minScale)!=null?p:0}readPointBarriers(e,r){return this._getNetworkFeatures(r,"Barriers",o=>re.fromGraphic(o))}readPolygonBarriers(e,r){return this._getNetworkFeatures(r,"PolygonBarriers",o=>oe.fromGraphic(o))}readPolylineBarriers(e,r){return this._getNetworkFeatures(r,"PolylineBarriers",o=>se.fromGraphic(o))}readRouteInfo(e,r){const o=this._getNetworkFeatures(r,"RouteInfo",i=>me.fromGraphic(i));return o.length>0?o.getItemAt(0):null}readSpatialReference(e,r){var c,g,b,l,T,R;const o=we(r)?r.layers:(c=r.featureCollection)==null?void 0:c.layers;if(!(o!=null&&o.length))return K.WGS84;const{layerDefinition:i,featureSet:n}=o[0],p=n.features[0],a=(R=(T=(l=(b=(g=ae(p==null?void 0:p.geometry))==null?void 0:g.spatialReference)!=null?b:n.spatialReference)!=null?l:i.spatialReference)!=null?T:i.extent.spatialReference)!=null?R:it;return K.fromJSON(a)}readStops(e,r){return this._getNetworkFeatures(r,"Stops",o=>ie.fromGraphic(o),o=>this._setStopSymbol(o))}get title(){return m(this.routeInfo)&&m(this.routeInfo.name)?this.routeInfo.name:"Route"}set title(e){this._overrideIfSome("title",e)}get url(){return nt.routeServiceUrl}set url(e){e!=null?this._set("url",Gt(e,Rt)):this._set("url",nt.routeServiceUrl)}load(e){return this.addResolvingPromise(this.loadFromPortal({supportedTypes:["Feature Collection"]},e)),Promise.resolve(this)}removeAll(){this.removeResult(),this.pointBarriers.removeAll(),this.polygonBarriers.removeAll(),this.polylineBarriers.removeAll(),this.stops.removeAll()}removeResult(){m(this.directionLines)&&(this.directionLines.removeAll(),this._set("directionLines",null)),m(this.directionPoints)&&(this.directionPoints.removeAll(),this._set("directionPoints",null)),m(this.routeInfo)&&this._set("routeInfo",null)}async save(){await this.load();const{fullExtent:e,portalItem:r}=this;if(!r)throw new x("routelayer:portal-item-not-set","save() requires to the layer to have a portal item");if(!r.id)throw new x("routelayer:portal-item-not-saved","Please use saveAs() first to save the routelayer");if(r.type!=="Feature Collection")throw new x("routelayer:portal-item-wrong-type",'Portal item needs to have type "Feature Collection"');if(L(this.routeInfo))throw new x("routelayer:route-unsolved","save() requires a solved route");const{portal:o}=r;await o.signIn(),o.user||await r.reload();const{itemUrl:i,itemControl:n}=r;if(n!=="admin"&&n!=="update")throw new x("routelayer:insufficient-permissions","To save this layer, you need to be the owner or an administrator of your organization");const p={messages:[],origin:"portal-item",portal:o,url:i?Wt(i):void 0,writtenProperties:[]},a=this.write(void 0,p);return r.extent=await ct(e),r.title=this.title,await r.update({data:a}),r}async saveAs(e,r={}){var c,g,b,l;if(await this.load(),L(this.routeInfo))throw new x("routelayer:route-unsolved","saveAs() requires a solved route");const o=qt.from(e).clone();(c=o.extent)!=null||(o.extent=await ct(this.fullExtent)),o.id=null,(g=o.portal)!=null||(o.portal=Vt.getDefault()),(b=o.title)!=null||(o.title=this.title),o.type="Feature Collection",o.typeKeywords=["Data","Feature Collection",Zt.MULTI_LAYER,"Route Layer"];const{portal:i}=o,n={messages:[],origin:"portal-item",portal:i,url:null,writtenProperties:[]};await i.signIn();const p=r==null?void 0:r.folder,a=this.write(void 0,n);return await((l=i.user)==null?void 0:l.addItem({item:o,folder:p,data:a})),this.portalItem=o,rr(n),n.portalItem=o,o}async solve(e,r){var h,d,f,w,v,$;const o=(h=e==null?void 0:e.stops)!=null?h:this.stops,i=(d=e==null?void 0:e.pointBarriers)!=null?d:Ne(this.pointBarriers),n=(f=e==null?void 0:e.polylineBarriers)!=null?f:Ne(this.polylineBarriers),p=(w=e==null?void 0:e.polygonBarriers)!=null?w:Ne(this.polygonBarriers);if(L(o))throw new x("routelayer:undefined-stops","the route layer must have stops defined in the route parameters.");if((Wr(o)||qr(o))&&o.features.length<2||k.isCollection(o)&&o.length<2)throw new x("routelayer:insufficent-stops","the route layer must have two or more stops to solve a route.");if(k.isCollection(o))for(const I of o)I.routeName=null;const a=e==null?void 0:e.apiKey,c=this.url,g=await this._getServiceDescription(c,a,r),b=(v=e==null?void 0:e.travelMode)!=null?v:g.defaultTravelMode,l=($=ae(e==null?void 0:e.accumulateAttributes))!=null?$:[];m(b)&&(l.push(b.distanceAttributeName),b.timeAttributeName&&l.push(b.timeAttributeName));const T={startTime:new Date},R={accumulateAttributes:l,directionsOutputType:"featuresets",ignoreInvalidLocations:!0,pointBarriers:i,polylineBarriers:n,polygonBarriers:p,preserveFirstStop:!0,preserveLastStop:!0,returnBarriers:!!i,returnDirections:!0,returnPolygonBarriers:!!p,returnPolylineBarriers:!!n,returnRoutes:!0,returnStops:!0,stops:o},P=e?ut.from(e):new ut;for(const I in T)P[I]==null&&(P[I]=T[I]);let S;P.set(R);try{S=await Dr(c,P,r)}catch(I){throw zt(I)?I:new x("routelayer:failed-route-request","the routing request failed",{error:I})}const B=this._toRouteLayerSolution(S);return this._isOverridden("title")||(this.title=Kt(B.routeInfo.name,"Route")),Vr(B,g,P),B}update(e){const{stops:r,directionLines:o,directionPoints:i,pointBarriers:n,polylineBarriers:p,polygonBarriers:a,routeInfo:c}=e;this.set({stops:r,pointBarriers:n,polylineBarriers:p,polygonBarriers:a}),this._set("directionLines",o),this._set("directionPoints",i),this._set("routeInfo",c),m(c.geometry)&&(this.spatialReference=c.geometry.spatialReference)}_getNetworkFeatures(e,r,o,i){var S,B,h,d,f;const n=(B=we(e)?e.layers:(S=e.featureCollection)==null?void 0:S.layers)==null?void 0:B.find(w=>w.layerDefinition.name===r);if(L(n))return new k;const{layerDefinition:p,popupInfo:a,featureSet:c}=n,g=p.drawingInfo.renderer,{features:b}=c,l=(f=(d=(h=c.spatialReference)!=null?h:p.spatialReference)!=null?d:p.extent.spatialReference)!=null?f:it,T=g&&Ht(g),R=K.fromJSON(l),P=b.map(w=>{var I,j,le;const v=Y.fromJSON(w);m(v.geometry)&&m(w.geometry)&&L(w.geometry.spatialReference)&&(v.geometry.spatialReference=R);const $=o(v);return(j=$.symbol)!=null||($.symbol=(I=T==null?void 0:T.getSymbol(v))!=null?I:this._getNetworkSymbol(r)),(le=$.popupTemplate)!=null||($.popupTemplate=a&&Xt.fromJSON(a)),$});return i&&P.some(w=>!w.symbol)&&i(P),new k(P)}_getNetworkSymbol(e){switch(e){case"Barriers":return this.defaultSymbols.pointBarriers;case"DirectionPoints":return this.defaultSymbols.directionPoints;case"DirectionLines":return this.defaultSymbols.directionLines;case"PolylineBarriers":return this.defaultSymbols.polylineBarriers;case"PolygonBarriers":return this.defaultSymbols.polygonBarriers;case"RouteInfo":return this.defaultSymbols.routeInfo;case"Stops":return null}}async _getServiceDescription(e,r,o){if(m(this._cachedServiceDescription)&&this._cachedServiceDescription.url===e)return this._cachedServiceDescription.serviceDescription;const i=await Nt(e,r,o);return this._cachedServiceDescription={serviceDescription:i,url:e},i}_setStopSymbol(e){if(!e||e.length===0||L(this.defaultSymbols.stops)||e.every(l=>m(l.symbol)))return;const{first:r,last:o,middle:i,unlocated:n,waypoint:p,break:a}=this.defaultSymbols.stops;if(L(this.routeInfo)||e.length===1)return void e.forEach((l,T)=>{switch(T){case 0:l.symbol=r;break;case e.length-1:l.symbol=o;break;default:l.symbol=i}});const c=e.map(l=>l.sequence).filter(l=>m(l)),g=Math.min(...c),b=Math.max(...c);for(const l of e)l.sequence!==g?l.sequence!==b?l.status==="ok"||l.status==="not-located-on-closest"?l.locationType!=="waypoint"?l.locationType!=="break"?l.symbol=i:l.symbol=a:l.symbol=p:l.symbol=n:l.symbol=o:l.symbol=r}_toRouteLayerSolution(e){var b,l,T,R,P,S,B;const r=(b=e.routeResults[0].stops)==null?void 0:b.map(h=>ie.fromJSON(h.toJSON()));this._setStopSymbol(r);const o=new ft(r),i=new dt((l=e.polygonBarriers)==null?void 0:l.map(h=>{const d=oe.fromJSON(h.toJSON());return d.symbol=this.defaultSymbols.polygonBarriers,d})),n=new mt((T=e.polylineBarriers)==null?void 0:T.map(h=>{const d=se.fromJSON(h.toJSON());return d.symbol=this.defaultSymbols.polylineBarriers,d})),p=new yt((R=e.pointBarriers)==null?void 0:R.map(h=>{const d=re.fromJSON(h.toJSON());return d.symbol=this.defaultSymbols.pointBarriers,d})),a=(P=e.routeResults[0].route)==null?void 0:P.toJSON(),c=me.fromJSON(a);c.symbol=this.defaultSymbols.routeInfo;const g=new Kr((S=e.routeResults[0].directionPoints)==null?void 0:S.features.map(h=>{const d=ue.fromJSON(h.toJSON());return d.symbol=this.defaultSymbols.directionPoints,d}));return{directionLines:new zr((B=e.routeResults[0].directionLines)==null?void 0:B.features.map(h=>{const d=pe.fromJSON(h.toJSON());return d.symbol=this.defaultSymbols.directionLines,d})),directionPoints:g,pointBarriers:p,polygonBarriers:i,polylineBarriers:n,routeInfo:c,stops:o}}_writeDirectionLines(){return this._writeNetworkFeatures(this.directionLines,this.defaultSymbols.directionLines,"esriGeometryPolyline",pe.fields,pe.popupInfo,"DirectionLines","Direction Lines")}_writeDirectionPoints(){return this._writeNetworkFeatures(this.directionPoints,this.defaultSymbols.directionPoints,"esriGeometryPoint",ue.fields,ue.popupInfo,"DirectionPoints","Direction Points")}_writeNetworkFeatures(e,r,o,i,n,p,a){if(L(e)||!e.length)return null;const c=this.spatialReference.toJSON(),{fullExtent:g,maxScale:b,minScale:l}=this;return{featureSet:{features:e.toArray().map(T=>Zr(T)),geometryType:o,spatialReference:c},layerDefinition:{capabilities:"Query,Update,Editing",drawingInfo:{renderer:{type:"simple",symbol:m(r)?r.toJSON():Le(o)}},extent:g.toJSON(),fields:i,geometryType:o,hasM:!1,hasZ:!1,maxScale:b,minScale:l,name:p,objectIdField:"ObjectID",spatialReference:c,title:a,type:"Feature Layer",typeIdField:""},popupInfo:n}}_writePointBarriers(){return this._writeNetworkFeatures(this.pointBarriers,this.defaultSymbols.pointBarriers,"esriGeometryPoint",re.fields,re.popupInfo,"Barriers","Point Barriers")}_writePolygonBarriers(){return this._writeNetworkFeatures(this.polygonBarriers,this.defaultSymbols.polygonBarriers,"esriGeometryPolygon",oe.fields,oe.popupInfo,"PolygonBarriers","Polygon Barriers")}_writePolylineBarriers(){return this._writeNetworkFeatures(this.polylineBarriers,this.defaultSymbols.polylineBarriers,"esriGeometryPolyline",se.fields,se.popupInfo,"PolylineBarriers","Line Barriers")}_writeRouteInfo(){return this._writeNetworkFeatures(m(this.routeInfo)?new k([this.routeInfo]):null,this.defaultSymbols.routeInfo,"esriGeometryPolyline",me.fields,me.popupInfo,"RouteInfo","Route Details")}_writeStops(){const e=this._writeNetworkFeatures(this.stops,null,"esriGeometryPoint",ie.fields,ie.popupInfo,"Stops","Stops");if(L(e))return null;const{stops:r}=this.defaultSymbols,o=m(r)&&m(r.first)&&r.first.toJSON(),i=m(r)&&m(r.middle)&&r.middle.toJSON(),n=m(r)&&m(r.last)&&r.last.toJSON();return e.layerDefinition.drawingInfo.renderer={type:"uniqueValue",field1:"Sequence",defaultSymbol:i,uniqueValueInfos:[{value:"1",symbol:o,label:"First Stop"},{value:`${this.stops.length}`,symbol:n,label:"Last Stop"}]},e}};t([s({readOnly:!0,json:{read:!1,origins:{"portal-item":{write:{allowNull:!0,ignoreOrigin:!0}},"web-map":{write:{overridePolicy(){return{allowNull:!0,ignoreOrigin:this.portalItem==null}}}}}}})],N.prototype,"_featureCollection",void 0),t([z(["web-map","portal-item"],"_featureCollection")],N.prototype,"writeFeatureCollectionWebmap",null),t([s({readOnly:!0,json:{read:!1,origins:{"web-map":{write:{target:"type",overridePolicy(){return{ignoreOrigin:this.portalItem!=null}}}}}}})],N.prototype,"_type",void 0),t([s({nonNullable:!0,type:Bt})],N.prototype,"defaultSymbols",void 0),t([s({readOnly:!0})],N.prototype,"directionLines",void 0),t([A(["web-map","portal-item"],"directionLines",["layers","featureCollection.layers"])],N.prototype,"readDirectionLines",null),t([s({readOnly:!0})],N.prototype,"directionPoints",void 0),t([A(["web-map","portal-item"],"directionPoints",["layers","featureCollection.layers"])],N.prototype,"readDirectionPoints",null),t([s({readOnly:!0,json:{read:!1,origins:{"web-map":{write:{ignoreOrigin:!0}}}}})],N.prototype,"featureCollectionType",void 0),t([s({readOnly:!0})],N.prototype,"fullExtent",null),t([s({json:{origins:{"web-map":{name:"featureCollection.showLegend"}},write:!0}})],N.prototype,"legendEnabled",void 0),t([s({type:["show","hide"]})],N.prototype,"listMode",void 0),t([s({type:Number,nonNullable:!0,json:{write:!1}})],N.prototype,"maxScale",void 0),t([A(["web-map","portal-item"],"maxScale",["layers","featureCollection.layers"])],N.prototype,"readMaxScale",null),t([s({type:Number,nonNullable:!0,json:{write:!1}})],N.prototype,"minScale",void 0),t([A(["web-map","portal-item"],"minScale",["layers","featureCollection.layers"])],N.prototype,"readMinScale",null),t([s({type:["ArcGISFeatureLayer"],value:"ArcGISFeatureLayer"})],N.prototype,"operationalLayerType",void 0),t([s({nonNullable:!0,type:k.ofType(re)})],N.prototype,"pointBarriers",void 0),t([A(["web-map","portal-item"],"pointBarriers",["layers","featureCollection.layers"])],N.prototype,"readPointBarriers",null),t([s({nonNullable:!0,type:k.ofType(oe)})],N.prototype,"polygonBarriers",void 0),t([A(["web-map","portal-item"],"polygonBarriers",["layers","featureCollection.layers"])],N.prototype,"readPolygonBarriers",null),t([s({nonNullable:!0,type:k.ofType(se)})],N.prototype,"polylineBarriers",void 0),t([A(["web-map","portal-item"],"polylineBarriers",["layers","featureCollection.layers"])],N.prototype,"readPolylineBarriers",null),t([s({readOnly:!0})],N.prototype,"routeInfo",void 0),t([A(["web-map","portal-item"],"routeInfo",["layers","featureCollection.layers"])],N.prototype,"readRouteInfo",null),t([s({type:K})],N.prototype,"spatialReference",void 0),t([A(["web-map","portal-item"],"spatialReference",["layers","featureCollection.layers"])],N.prototype,"readSpatialReference",null),t([s({nonNullable:!0,type:k.ofType(ie)})],N.prototype,"stops",void 0),t([A(["web-map","portal-item"],"stops",["layers","featureCollection.layers"])],N.prototype,"readStops",null),t([s()],N.prototype,"title",null),t([s({readOnly:!0,json:{read:!1}})],N.prototype,"type",void 0),t([s()],N.prototype,"url",null),N=t([M($t)],N);const Yr=N;export{Yr as default};
