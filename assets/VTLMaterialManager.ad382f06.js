import{fw as t}from"./index.a33ecea7.js";import{n}from"./resolver.110e6527.js";import{n as i}from"./programUtils.00364c53.js";const o=e=>i({ID:e.id,PATTERN:e.pattern}),E={shaders:e=>({vertexShader:o(e)+n("background/background.vert"),fragmentShader:o(e)+n("background/background.frag")})},g=e=>i({ID:e.id}),L={shaders:e=>({vertexShader:g(e)+n("circle/circle.vert"),fragmentShader:g(e)+n("circle/circle.frag")})},h=e=>i({ID:e.id,PATTERN:e.pattern}),D={shaders:e=>({vertexShader:h(e)+n("fill/fill.vert"),fragmentShader:h(e)+n("fill/fill.frag")})},l=e=>i({ID:e.id}),N={shaders:e=>({vertexShader:l(e)+n("outline/outline.vert"),fragmentShader:l(e)+n("outline/outline.frag")})},u=e=>i({ID:e.id,SDF:e.sdf}),_={shaders:e=>({vertexShader:u(e)+n("icon/icon.vert"),fragmentShader:u(e)+n("icon/icon.frag")})},f=e=>i({ID:e.id,PATTERN:e.pattern,SDF:e.sdf}),C={shaders:e=>({vertexShader:f(e)+n("line/line.vert"),fragmentShader:f(e)+n("line/line.frag")})},p=e=>i({ID:e.id}),B={shaders:e=>({vertexShader:p(e)+n("text/text.vert"),fragmentShader:p(e)+n("text/text.frag")})};class A{constructor(){this._programByKey=new Map}dispose(){this._programByKey.forEach(s=>s.dispose()),this._programByKey.clear()}getMaterialProgram(s,a,r){const d=a.key<<3|this._getMaterialOptionsValue(a.type,r);if(this._programByKey.has(d))return this._programByKey.get(d);const m=this._getProgramTemplate(a.type),{shaders:S}=m,{vertexShader:I,fragmentShader:v}=S(r),y=a.getShaderHeader(),T=a.getShaderMain(),x=I.replace("#pragma header",y).replace("#pragma main",T),c=s.programCache.acquire(x,v,a.getAttributeLocations());return this._programByKey.set(d,c),c}_getMaterialOptionsValue(s,a){switch(s){case t.BACKGROUND:{const r=a;return(r.pattern?1:0)<<1|(r.id?1:0)}case t.FILL:{const r=a;return(r.pattern?1:0)<<1|(r.id?1:0)}case t.OUTLINE:return a.id?1:0;case t.LINE:{const r=a;return(r.sdf?1:0)<<2|(r.pattern?1:0)<<1|(r.id?1:0)}case t.ICON:{const r=a;return(r.sdf?1:0)<<1|(r.id?1:0)}case t.CIRCLE:return a.id?1:0;case t.TEXT:return a.id?1:0;default:return 0}}_getProgramTemplate(s){switch(s){case t.BACKGROUND:return E;case t.CIRCLE:return L;case t.FILL:return D;case t.ICON:return _;case t.LINE:return C;case t.OUTLINE:return N;case t.TEXT:return B;default:return null}}}export{A as o};
