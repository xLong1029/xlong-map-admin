import{a7 as Yt,i5 as X,cP as I,hN as U,lY as st,j3 as qt,jn as Bt,gp as Ot,j8 as Tt,m9 as Et,j7 as zt,j9 as Zt,bp as Jt,jb as Qt,jc as Kt,jd as ts,je as ss,mc as ns,bR as Z,bv as es,jg as is,ji as rs,mg as os,oW as as,mh as cs,mi as ds,br as ls,bs as us,ju as gs,n as hs,mj as $,im as It,r as F,gl as ps,nj as at,om as bs,nD as _s,n2 as c,ah as v,nw as Wt,i6 as P,aN as nt,aP as b,aQ as h,oX as _t,oU as Y,nE as jt,hJ as G,oY as kt,hX as O,oZ as xt,nl as D,nm as Ht,nn as E,no as A,np as fs,ak as et,l7 as L,o_ as $s,o$ as J,i9 as Q,mF as ms,nC as wt,p0 as At,gQ as lt,hu as Ct,p1 as Rt,p2 as vt,p3 as Pt,p4 as Os,p5 as yt,iu as x,l6 as C,oS as Ts,p6 as Es,p7 as gt,p8 as Is,p9 as ws,n3 as As,iv as Cs,nq as Rs,i as V,m3 as vs,bB as Ft,nH as Ps,oP as Ls,oO as Dt,pa as ht,lM as Lt,oR as Ns,pb as Ss,ae as Ms}from"./index.a33ecea7.js";import{n as Vs,g as Us,b as Ws}from"./LineVisualElement.ea11337b.js";const In=Yt("mac")?"Meta":"Control",wn="Shift",js=2,ks=1.15,xs=1.15,An=2500,Cn=.02,Hs=Math.cos(st(45)),Nt=Math.cos(st(5)),Rn=.95,vn=.3,ys=.7,q=I(1,.5,0),Pn=2,Fs=1,Ds=X([...q,ys]),Gs=[0,0,0,.04],Xs=X([...q,.5]),Ys=U(1,1,1,1),qs=U(1,.8,.6,1),Bs=U(1,.93,.86,1),zs=X([...q,1]),Zs=X([...q,1]),Js=3,Gt=11,pt=22.5,tt=40,St=48,Qs=2.25,Ks=X([...q,1]),tn=4,Mt=1,sn=.3,nn=6,en=4,Vt=1600,rn=.4;function on(t){const s=new qt;s.extensions.add("GL_OES_standard_derivatives");const{vertex:n,fragment:i,attributes:r,varyings:o}=s;return Bt(n,t),r.add(Ot.POSITION,"vec3"),r.add(Ot.UV0,"vec2"),o.add("vUV","vec2"),n.code.add(Tt`void main(void) {
vUV = uv0;
gl_Position = proj * view * vec4(position, 1.0);
}`),i.uniforms.add([new Et("backgroundColor",e=>e.backgroundColor),new Et("gridColor",e=>e.gridColor),new zt("gridWidth",e=>e.gridWidth)]),i.code.add(Tt`void main() {
const float LINE_WIDTH = 1.0;
vec2 uvScaled = vUV * gridWidth;
vec2 gridUV = (fract(uvScaled + 0.5) - 0.5) / (LINE_WIDTH * fwidth(uvScaled));
vec2 grid = (1.0 - step(0.5, gridUV)) * step(-0.5, gridUV);
grid.x *= step(0.5, uvScaled.x) * step(uvScaled.x, gridWidth - 0.5);
grid.y *= step(0.5, uvScaled.y) * step(uvScaled.y, gridWidth - 0.5);
float gridFade = max(grid.x, grid.y);
float gridAlpha = gridColor.a * gridFade;
gl_FragColor =
vec4(backgroundColor.rgb * backgroundColor.a, backgroundColor.a) * (1.0 - gridAlpha) +
vec4(gridColor.rgb, 1.0) * gridAlpha;
}`),s}const an=Object.freeze(Object.defineProperty({__proto__:null,build:on},Symbol.toStringTag,{value:"Module"}));class cn extends rs{constructor(){super(...arguments),this.backgroundColor=U(1,0,0,.5),this.gridColor=U(0,1,0,.5),this.gridWidth=4}}class ct extends Qt{initializeProgram(s){return new Kt(s.rctx,ct.shader.get().build(this.configuration),ts)}initializePipeline(){return ss({blending:ns(Z.ONE,Z.ONE,Z.ONE_MINUS_SRC_ALPHA,Z.ONE_MINUS_SRC_ALPHA),depthTest:{func:es.LESS},colorWrite:is})}}ct.shader=new Zt(an,()=>Jt(()=>import("./SlicePlaneMaterial.glsl.6027b219.js"),["assets/SlicePlaneMaterial.glsl.6027b219.js","assets/index.a33ecea7.js","assets/index.56d92a5e.css","assets/LineVisualElement.ea11337b.js"]));class dn extends os{constructor(s){super(s,new un),this._configuration=new as}createBufferWriter(){return new cs(ds)}requiresSlot(s,n){return n===ls.Color&&s===us.TRANSPARENT_DEPTH_WRITE_DISABLED_MATERIAL}createGLMaterial(s){return new ln(s)}getConfiguration(){return this._configuration}}class ln extends gs{constructor(s){super(s),this.ensureTechnique(ct,null)}beginSlot(){return hs(this.technique)}}class un extends cn{constructor(){super(...arguments),this.renderOccluded=$.Occlude}}class gn extends Vs{constructor(s){super(s),this._material=null,this._renderOccluded=$.OccludeAndTransparent,this._gridWidth=1,this._gridColor=U(1,0,0,1),this._backgroundColor=U(1,0,0,1),this.applyProps(s)}get renderOccluded(){return this._renderOccluded}set renderOccluded(s){s!==this._renderOccluded&&(this._renderOccluded=s,this._updateMaterial())}get gridWidth(){return this._gridWidth}set gridWidth(s){this._gridWidth!==s&&(this._gridWidth=s,this._updateMaterial())}get gridColor(){return this._gridColor}set gridColor(s){It(this._gridColor,s),this._updateMaterial()}get backgroundColor(){return this._backgroundColor}set backgroundColor(s){It(this._backgroundColor,s),this._updateMaterial()}createExternalResources(){this._material=new dn(this._materialParameters)}destroyExternalResources(){this._material=null}forEachExternalMaterial(s){F(this._material)&&s(this._material)}createGeometries(s){if(F(this._material)){const n=ps(this._material);s.addGeometry(n)}}get _materialParameters(){return{backgroundColor:this._backgroundColor,gridWidth:this._gridWidth,gridColor:this._gridColor,renderOccluded:this._renderOccluded}}_updateMaterial(){F(this._material)&&this._material.setParameters(this._materialParameters)}}function Ln(t,s,n,i,r,o,e,a){return hn(s,e.worldUpAtPosition(t,c.get()),r,o,a.basis1,a.basis2),h(a.basis1,a.basis1,n),h(a.basis2,a.basis2,i),v(a.origin,t),yt(a.basis2,a.basis1,a.origin,a.plane),a}function hn(t,s,n,i,r,o){const e=x(t,s),a=c.get(),d=c.get();switch(i===R.HORIZONTAL_OR_VERTICAL?Math.abs(e)>Hs?R.HORIZONTAL:R.VERTICAL:i){case R.VERTICAL:{const l=Math.abs(e)<=Nt?t:n.viewUp;C(a,l,s),v(d,s);break}case R.HORIZONTAL:C(a,n.viewUp,s),C(d,s,a);break;case R.TILTED:{const l=Math.abs(e)<=Nt?s:n.viewUp;C(a,l,t),C(d,t,a);break}}const g=C(c.get(),a,d);x(g,n.viewForward)>0&&h(d,d,-1),L(r,a),L(o,d)}function pn(t,s,n){const i=s.worldUpAtPosition(t.origin,c.get()),r=t.basis1,o=mt(t,i),e=Math.round(o/H)*H;return ht(t,e-o,r,n)}function Nn(t,s,n,i,r,o){const e=v(c.get(),r.origin);b(e,e,h(c.get(),r.basis1,t.direction[0]<0?1:-1)),b(e,e,h(c.get(),r.basis2,t.direction[1]<0?1:-1));const a=P(r.basis1),d=P(r.basis2),g=O(c.get(),n,e),l=O(c.get(),s,e);let u=0,p=0;if($t(t)){const B=bt(r),S=bt(o);u=a-.5*t.direction[0]*x(r.basis1,l)/a,p=d-.5*t.direction[1]*x(r.basis2,l)/d;const j=S/B;u*=j,p*=j}const m=u+.5*t.direction[0]*x(r.basis1,g)/a,f=p+.5*t.direction[1]*x(r.basis2,g)/d,W=h(c.get(),r.basis1,m/a),N=h(c.get(),r.basis2,f/d);(m<=0||Ut(o.origin,W,i)<=Vt)&&v(W,o.basis1),(f<=0||Ut(o.origin,N,i)<=Vt)&&v(N,o.basis2);const _=v(c.get(),e);return b(_,_,h(c.get(),W,t.direction[0]<0?-1:1)),b(_,_,h(c.get(),N,t.direction[1]<0?-1:1)),Ts(_,W,N,o)}function Sn(t,s){return rn*Math.min(s.width,s.height)*s.computeRenderPixelSizeAt(t)}function Mn(t,s,n,i){const r=C(c.get(),s,n);return C(r,r,s),Wt(t,r,i)}function Vn(t,s){return _s(t.basis1,t.basis2,t.origin,s)}function Un(t,s,n,i){const r=s.worldUpAtPosition(t.origin,c.get()),o=c.get();switch(n){case it.HEADING:v(o,r);break;case it.TILT:v(o,t.basis1)}return Wt(t.origin,o,i)}function Wn(t,s,n,i){const r=ft(n,w.NEGATIVE_X),o=Y.get();Es(o,s,r.edge*Math.PI/2);const e=L(c.get(),r.basis);let a=h(c.get(),e,r.direction*i.computeScreenPixelSizeAt(r.position)*tt);b(a,a,r.position);const d=i.projectToRenderScreen(a,gt(c.get())),g=bn(i,d);Is(i,d,K),L(K.direction,K.direction);const l=c.get();!g&&ws(n,K,l)&&(a=l),o[12]=0,o[13]=0,o[14]=0,t.modelTransform=o,t.renderLocation=As(a),g?t.state|=rt:t.state&=~rt}function bn(t,s){const[n,i,r,o]=t.viewport,e=Math.min(r,o)/16;let a=!0;return s[0]<n+e?(s[0]=n+e,a=!1):s[0]>n+r-e&&(s[0]=n+r-e,a=!1),s[1]<i+e?(s[1]=i+e,a=!1):s[1]>i+o-e&&(s[1]=i+o-e,a=!1),a}function jn(t,s,n,i){const r=P(i.basis1),o=P(i.basis2),e=Xt(i),a=bt(i),d=nt(c.get(),0,0,0);b(d,h(c.get(),i.basis1,s.direction[0]),h(c.get(),i.basis2,s.direction[1])),b(d,i.origin,d);let g=0,l=1;if($t(s))s.direction[0]===1&&s.direction[1]===-1?g=H:s.direction[0]===1&&s.direction[1]===1?g=Math.PI:s.direction[0]===-1&&s.direction[1]===1&&(g=3*Math.PI/2),l=a;else{const p=s.direction[0]!==0?1:2;g=p===1?H:0,l=(p===1?o:r)-e}const u=_t(Y.get(),g);jt(u,u,nt(c.get(),l,l,l)),G(u,n,u),u[12]=0,u[13]=0,u[14]=0,t.modelTransform=u,t.renderLocation=d}function kn(t,s,n,i){const r=i.worldUpAtPosition(n.origin,c.get()),o=ft(n,w.POSITIVE_X),e=_t(Y.get(),o.edge*Math.PI/2);kt(e,e,-mt(n,r)),G(e,s,e),e[12]=0,e[13]=0,e[14]=0,t.modelTransform=e,t.renderLocation=o.position}function xn(t,s,n){const i=ft(n,w.POSITIVE_Y),r=_t(Y.get(),i.edge*Math.PI/2);kt(r,r,H),G(r,s,r),r[12]=0,r[13]=0,r[14]=0,t.modelTransform=r,t.renderLocation=i.position}var w;function ft(t,s){switch(s){case w.POSITIVE_X:return{basis:t.basis1,direction:1,position:b(c.get(),t.origin,t.basis1),edge:s};case w.POSITIVE_Y:return{basis:t.basis2,direction:1,position:b(c.get(),t.origin,t.basis2),edge:s};case w.NEGATIVE_X:return{basis:t.basis1,direction:-1,position:O(c.get(),t.origin,t.basis1),edge:s};case w.NEGATIVE_Y:return{basis:t.basis2,direction:-1,position:O(c.get(),t.origin,t.basis2),edge:s}}}function Ut(t,s,n){const i=n.projectToRenderScreen(b(c.get(),t,s),gt(c.get())),r=n.projectToRenderScreen(O(c.get(),t,s),gt(c.get()));return Cs(O(i,i,r))}function Xt(t){const s=P(t.basis1),n=P(t.basis2);return sn*Math.min(s,n)}function bt(t){return Xt(t)}function $t(t){return t.direction[0]!==0&&t.direction[1]!==0}function Hn(t,s=ot.CENTER_ON_ARROW){const n=s===ot.CENTER_ON_CALLOUT?tt:0,i=[I(n,0,-St/2),I(n,0,St/2)],r=$n(i,!0),o=(u,p)=>_n(i,u,p),e=o(0,!1),a=o(Qs,!0),d=new xt({color:zs,renderOccluded:$.OccludeAndTransparent}),g=D(d,[[n,0,0],[n-tt,0,0]]),l=D(d,[[n,0,0],[n-tt,0,0]]);return new Ht({view:t,renderObjects:[...e.normal.map(u=>new E(u,A.Unfocused|T)),...a.normal.map(u=>new E(u,A.Unfocused|T)),new E(g,A.Unfocused|T|rt),...e.focused.map(u=>new E(u,A.Focused|T)),...a.focused.map(u=>new E(u,A.Focused|T)),new E(l,A.Focused|T|rt)],autoScaleRenderObjects:!1,collisionType:{type:"line",paths:[r]},collisionPriority:1,radius:Gt,state:T})}function yn(t,s){const n=Rs(t,{customStateMask:T,texture:s});return n.state=T,n}function Fn(t){const s=[[-1,-1,0],[1,-1,0],[1,1,0],[-1,1,0],[-1,-1,0]];return new Us({view:t,attached:!1,color:Ds,width:Fs,writeDepthEnabled:!1,renderOccluded:$.OccludeAndTransparent,geometry:[s]})}function Dn(t){return new gn({view:t,attached:!1,backgroundColor:[...Gs],gridColor:Xs,gridWidth:4,renderOccluded:$.OccludeAndTransparent})}function Gn(t,s){const n=$t(s),i=n?[I(1,0,0),I(0,0,0),I(0,1,0)]:[I(1,0,0),I(-1,0,0)],r=Ks,o=m=>new ms({color:r,width:m,renderOccluded:$.OccludeAndTransparent}),e=()=>new xt({color:r,renderOccluded:$.OccludeAndTransparent}),a=n?tn:Mt,d=a*js,g=Mt,l=m=>m>1?o(m):e(),u=[new E(D(l(a),i),A.Unfocused|ut),new E(D(l(d),i),A.Focused|ut),new E(D(l(g),i),On)],p=new Ht({view:t,renderObjects:u,collisionType:{type:"line",paths:[i]},radius:n?nn:en,...fs});return p.state=ut,p}function _n(t,s,n){const i=new J({color:Ys,cullFace:Q.Back,renderOccluded:$.Opaque}),r=new J({color:qs,cullFace:Q.Back,renderOccluded:$.Opaque}),o=new J({color:Bs,cullFace:Q.Back,renderOccluded:$.Opaque}),e=new J({color:Zs,transparent:!0,writeDepth:!1,cullFace:Q.Front,renderOccluded:$.Transparent}),a=d=>{t=t.slice(0);const g=O(c.get(),t[0],t[1]);L(g,g);const l=O(c.get(),t[t.length-1],t[t.length-2]);if(L(l,l),s>0){const y=h(et(),l,-s);t[t.length-1]=b(y,y,t[t.length-1]);const k=h(et(),g,-s);t[0]=b(k,k,t[0])}const u=d?xs:1,p=pt*u,m=Gt*u,f=wt(Y.get());if(s>0){const y=p/4,k=nt(c.get(),0,y,0),z=1+s/y;At(f,f,k),jt(f,f,nt(c.get(),z,z,z)),At(f,f,h(k,k,-1/z))}const W=wt(lt()),N=I(0,1,0),_=Ct(lt(),Rt(vt.get(),N,l));_[12]=t[t.length-1][0],_[13]=t[t.length-1][1],_[14]=t[t.length-1][2],G(_,_,f);const B=fn(Js*(d?ks:1)+s,t,n?e:o);B.transformation=W;const S=[B],j=Pt(n?e:i,p,m,24,!1,!1,!0);j.transformation=_,S.push(j);const dt=Pt(n?e:r,p,m,24,!1,!0,!1);dt.transformation=_,S.push(dt);const M=Ct(lt(),Rt(vt.get(),N,g));return M[12]=t[0][0],M[13]=t[0][1],M[14]=t[0][2],G(M,M,f),S.push(j.instantiate({transformation:M})),S.push(dt.instantiate({transformation:M})),S};return{normal:a(!1),focused:a(!0)}}function fn(t,s,n){const i=[];for(let o=0;o<12;o++){const e=o/12*2*Math.PI;i.push([Math.cos(e)*t,Math.sin(e)*t])}return Os(n,i,s,[],[],!1)}function $n(t,s){const n=O(et(),t[t.length-1],t[t.length-2]);if(L(n,n),h(n,n,pt),b(n,n,t[t.length-1]),s){const i=O(et(),t[0],t[1]);return L(i,i),h(i,i,pt),b(i,i,t[0]),[i,...t,n]}return[...t,n]}function Xn(t,s,n,i=new Ls){if(V(t))return null;const{renderCoordsHelper:r}=s,o=r.fromRenderCoords(t.origin,s.spatialReference);if(V(o))return null;const e=vs(o,n);if(V(e))return null;i.position=e;const a=2*P(t.basis1),d=2*P(t.basis2),g=Ft.renderUnitScaleFactor(s.spatialReference,n);i.width=a*g,i.height=d*g;const l=r.worldUpAtPosition(t.origin,c.get());return i.tilt=Ps(mt(t,l)),i.heading=r.headingAtPosition(t.origin,t.basis1)-90,i}function mt(t,s){return $s(s,t.basis2,t.basis1)+H}function mn(t,s,n,i,r,o,e=Dt()){return o.toRenderCoords(t,e.origin)?(o.worldBasisAtPosition(e.origin,Lt.X,e.basis1),o.worldBasisAtPosition(e.origin,Lt.Y,e.basis2),yt(e.basis2,e.basis1,e.origin,e.plane),ht(e,-st(s),Ns(e),e),ht(e,st(n),e.basis1,e),h(e.basis1,e.basis1,i/2),h(e.basis2,e.basis2,r/2),Ss(e),e):(Ms.getLogger("esri.views.3d.analysis.Slice.sliceToolUtils").error(`Failed to project slice plane position, projection from ${t.spatialReference.wkid} is not supported`),null)}function Yn(t,s){if(V(t)||V(t.position))return null;const n=Ws(t.position,s.spatialReference,s.elevationProvider);if(V(n))return null;const i=Ft.renderUnitScaleFactor(t.position.spatialReference,s.spatialReference),r=t.width*i,o=t.height*i;return{position:n,heading:t.heading,tilt:t.tilt,renderWidth:r,renderHeight:o}}function qn(t,s,n,i=Dt()){if(V(t))return null;const r=mn(t.position,t.heading,t.tilt,t.renderWidth,t.renderHeight,s.renderCoordsHelper,i);return!n.tiltEnabled&&F(r)&&pn(r,s.renderCoordsHelper,r),r}(function(t){t[t.POSITIVE_X=0]="POSITIVE_X",t[t.POSITIVE_Y=1]="POSITIVE_Y",t[t.NEGATIVE_X=2]="NEGATIVE_X",t[t.NEGATIVE_Y=3]="NEGATIVE_Y"})(w||(w={}));const T=at.Custom1;var it,R;(function(t){t[t.HEADING=1]="HEADING",t[t.TILT=2]="TILT"})(it||(it={})),function(t){t[t.HORIZONTAL_OR_VERTICAL=0]="HORIZONTAL_OR_VERTICAL",t[t.HORIZONTAL=1]="HORIZONTAL",t[t.VERTICAL=2]="VERTICAL",t[t.TILTED=3]="TILTED"}(R||(R={}));const rt=at.Custom2,K=bs(),H=Math.PI/2,ut=at.Custom1,On=at.Custom2;var ot;function Bn(t){const s=t.type==="building-scene-3d"?t:null;return F(s)}(function(t){t[t.CENTER_ON_CALLOUT=0]="CENTER_ON_CALLOUT",t[t.CENTER_ON_ARROW=1]="CENTER_ON_ARROW"})(ot||(ot={}));export{Vn as B,Xs as C,T as E,Ln as G,it as I,jn as J,kn as K,vn as M,ot as N,qn as O,Bn as P,xn as Q,R,Yn as T,Mn as W,Nn as Y,Sn as Z,ut as _,yn as a,Pn as b,Fn as c,In as d,An as e,Ds as f,Xn as g,On as h,Cn as i,rt as j,Dn as l,wn as m,Rn as n,bt as o,Un as q,$t as r,Hn as s,on as t,Gn as u,Fs as v,Gs as x,Wn as z};
